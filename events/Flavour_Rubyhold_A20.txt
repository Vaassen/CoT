
namespace = flavor_rubyhold

#Lorents proposal
country_event = {
	id = flavor_rubyhold.1
	title = flavor_rubyhold.1.t
	desc = flavor_rubyhold.1.d

	fire_only_once = yes
	
	is_triggered_only = yes
	
	option = {
		name = flavor_rubyhold.1.a  # We built Lorent, now they can protect us.
		
		trigger = {
			is_part_of_hre = no
		}
		
		A01 = {	#Lorent
			vassalize = A20
			country_event = {
				id = flavor_lorent.5 #Rubyhold becomes a vassal
				days = 10 
			}
		}
		
		A20 = {
			add_country_modifier = {
				name = rubyhold_cot_rely_on_lorent # Mega debuff to make becoming a vassal ok.
				duration = 9125 # 25 years
			}
		}
	}
	
	option = {
		name = flavor_rubyhold.1.b # We shall pay for their protection, but this is a dwarf's throne.
		
		trigger = {
			is_part_of_hre = no
		}
		
		A01 = {
			set_country_flag = can_create_tributaries_flag
			create_subject = {
				subject_type = tributary_state
				subject = A20
			}
			
			country_event = {
				id = flavor_lorent.5 #Rubyhold becomes a tributary
				days = 10 
			}
		}
		
		A20 = {
			add_country_modifier = {
				name = rubyhold_cot_rely_on_lorent # Mega debuff to make becoming a vassal ok.
				duration = 9125 # 25 years
			}
		}
	}

	option = {
		name = flavor_rubyhold.1.c  # That's flattering, but we value our freedom.
		
		ai_chance = {
			factor = 0.4
			modifier = {
				factor = 2
				OR = {
					is_rival = A01
					A01 = { is_rival = A20 }
				}
			}
		}
		
		A01	= {#Lorent
			country_event = {
				id = flavor_lorent.5 #Rubyhold says no
				days = 10 
			}
		}
		
		A20 = {
			add_country_modifier = { 
				name = rubyhold_cot_defense_against_lorent #We get defensiveness and own_territory to defend against lorent
				duration = 1825
			}
		}
	}
	
	option = {
		name = flavor_rubyhold.1.e # Ye what? WE MADE YOU! You should be OUR vassal!
		
		ai_chance = {
			factor = 0.01
			modifier = {
				factor = 20
				OR = {
					is_rival = A01
					A01 = { is_rival = A20 }
				}
			}
		}
		
		A20 = {
			add_country_modifier = {
				name = rubyhold_cot_lorent_grudge_war # 1 global attacker bonus and 0.2 mp recovery
				duration = 730 # 2 years
			}
			infantry = ROOT
			infantry = ROOT
			infantry = ROOT
			infantry = ROOT
		}
		
		declare_war_with_cb = {
			who = A01
			casus_belli = cb_vassalize_mission
		}
		
		A01 = {
			country_event = {
				id = flavor_lorent.5
				days = 1
			}
		}
	}
	
	option = {
		name = flavor_rubyhold.1.f # If we are to be under anyone, the Empire will respect our autonomy at least.

		add_years_of_income = -2
		
		emperor = {
			country_event = { id = flavor_rubyhold.2 }
		}
		
		A01	= {#Lorent
			country_event = {
				id = flavor_lorent.5 #Rubyhold says no
				days = 10 
			}
		}
	}
}

#Rubyhold asks for entry
country_event = {
	id = flavor_rubyhold.2
	title = flavor_rubyhold.2.t
	desc = flavor_rubyhold.2.d

	fire_only_once = yes
	
	is_triggered_only = yes
	
	option = {
		name = flavor_rubyhold.2.a # Let them in!
			
		add_years_of_income = 0.5
		
		add_imperial_influence = 10
		
		A73 = {
			add_historical_rival = A20
			add_casus_belli = {
				type = cb_diplomatic_insult
				target = ROOT
			}
			add_aggressive_expansion = {
				who = ROOT
				value = 10
			}
		}

		A20 = {
			set_in_empire = yes
			add_historical_rival = A73
			country_event = { id = flavor_rubyhold.3 }
		}
	}
	
	option = {
		name = flavor_rubyhold.2.b # No, this may upset the balance.
		
		add_dip_power = 25
		
		A20 = {
			country_event = { id = flavor_rubyhold.3 }
		}
	}
}

#The Imperial Response
country_event = {
	id = flavor_rubyhold.3
	title = flavor_rubyhold.3.t
	desc = flavor_rubyhold.3.d

	fire_only_once = yes
	
	is_triggered_only = yes
	
	option = {
		name = flavor_rubyhold.3.a # So be it!
		
		trigger = {
			A20 = {
				is_part_of_hre = yes
			}
		}
	}
	
	option = {
		name = flavor_rubyhold.3.b # Bah, we'll be fine anyway.
		
		trigger = {
			A20 = {
				is_part_of_hre = no
			}
		}
		
		add_years_of_income = 1.9
	}
}