update_ass_points = {
	hidden_effect = {
		set_variable = {
			which = MaxAssPoints
			value = 10
		}
		set_variable = {
			which = MaxAssPointsBase
			value = 10
		}
		set_variable = {
			which = UsedAssPointsMinor
			value = 0
		}
		set_variable = {
			which = UsedAssPointsMiddle
			value = 0
		}
		set_variable = {
			which = UsedAssPointsMajor
			value = 0
		}
		set_variable = {
			which = UsedAssPointsVassalsUnder50
			value = 0
		}
		set_variable = {
			which = UsedAssPointsPUUnder75
			value = 0
		}
		set_variable = {
			which = UsedAssPointsLich
			value = 0
		}
		set_variable = {
			which = UsedAssPointsUndead
			value = 0
		}
		set_variable = {
			which = UsedAssPointsMonstrous
			value = 0
		}
		set_variable = {
			which = UsedAssPointsSemiMonstrous
			value = 0
		}
		set_variable = {
			which = UsedAssPointsAllyVassals
			value = 0
		}
		set_variable = {
			which = UsedAssPointsTotal
			value = 0
		}
		set_variable = {
			which = UsedAssPointsDifference
			value = 0
		}
		set_variable = {
			which = MaxAssPointsBenevolence
			value = 0
		}
		set_variable = {
			which = MaxAssPointsMajesty
			value = 0
		}
		set_variable = {
			which = MaxAssPointsEloquence
			value = 0
		}
		set_variable = {
			which = MaxAssPointsEmperor
			value = 0
		}
		set_variable = {
			which = MaxAssPointsRaja
			value = 0
		}
		set_variable = {
			which = MaxAssPointsKhet
			value = 0
		}
		set_variable = {
			which = MaxAssPointsPurity
			value = 0
		}
		if = {
			limit = { has_idea = dip1_7_a } 
			change_variable = {
				which = MaxAssPoints
				value = 2
			}
			change_variable = {
				which = MaxAssPointsEloquence
				value = 2
			}
		}
		
		if = {
			limit = { has_idea = dip11_7_a} 
			change_variable = {
				which = MaxAssPoints
				value = 1
			}
			change_variable = {
				which = MaxAssPointsMajesty
				value = 1
			}
		}
		if = {
			limit = { has_idea = dip7_7_a } 
			change_variable = {
				which = MaxAssPoints
				value = 1
			}
			change_variable = {
				which = MaxAssPointsBenevolence
				value = 1
			}
		}
		if = {
			limit = { is_emperor = yes }
			change_variable = {
				which = MaxAssPoints
				value = 1
			}
			change_variable = {
				which = MaxAssPointsEmperor
				value = 1
			}
		}
		if = {
			limit = { has_reform = raja_reform }
			change_variable = {
				which = MaxAssPoints
				value = 1
			}
			change_variable = {
				which = MaxAssPointsRaja
				value = 1
			}
		}
		if = {
			limit = { owns_core_province = 475 }
			change_variable = {
				which = MaxAssPoints
				value = 1
			}
			change_variable = {
				which = MaxAssPointsKhet
				value = 1
			}
		}
		if = {
			limit = { has_idea_group = dip2 }
			change_variable = {
				which = MaxAssPoints
				value = -99
			}
			change_variable = {
				which = MaxAssPointsPurity
				value = -99
			}
		}
		if = {
			limit = {
				has_country_modifier = assPoints_one
			}
			change_variable = {
				which = MaxAssPoints
				value = 1
			}
		}
		if = {
			limit = {
				has_country_modifier = assPoints_two
			}
			change_variable = {
				which = MaxAssPoints
				value = 2
			}
		}

		# Calc used points
		# Minor Powers
		if = {
			limit = {
				calc_true_if = {
					all_known_country = {
						AND = {
							is_great_power = no
							is_ass_ally = {
								me = PREV
								target = THIS
							}
						}
					}
					amount = 1
				}
			}
			change_variable = {
				which = UsedAssPointsMinor
				value = 3
			}
		}
		if = {
			limit = {
				calc_true_if = {
					all_known_country = {
						AND = {
							is_great_power = no
							is_ass_ally = {
								me = PREV
								target = THIS
							}
						}
					}
					amount = 2
				}
			}
			change_variable = {
				which = UsedAssPointsMinor
				value = 3
			}
		}
		if = {
			limit = {
				calc_true_if = {
					all_known_country = {
						AND = {
							is_great_power = no
							is_ass_ally = {
								me = PREV
								target = THIS
							}
						}
					}
					amount = 3
				}
			}
			change_variable = {
				which = UsedAssPointsMinor
				value = 3
			}
		}
		if = {
			limit = {
				calc_true_if = {
					all_known_country = {
						AND = {
							is_great_power = no
							is_ass_ally = {
								me = PREV
								target = THIS
							}
						}
					}
					amount = 4
				}
			}
			change_variable = {
				which = UsedAssPointsMinor
				value = 3
			}
		}
		if = {
			limit = {
				calc_true_if = {
					all_known_country = {
						AND = {
							is_great_power = no
							is_ass_ally = {
								me = PREV
								target = THIS
							}
						}
					}
					amount = 5
				}
			}
			change_variable = {
				which = UsedAssPointsMinor
				value = 3
			}
		}
		
		#Middle Powers
		
		if = {
			limit = {
				calc_true_if = {
					all_known_country = {
						AND = {
							is_great_power = yes
							is_ass_ally = {
								me = PREV
								target = THIS
							}
							great_power_rank = 6
						}
					}
					amount = 1
				}
			}
			change_variable = {
				which = UsedAssPointsMiddle
				value = 5
			}
		}
		if = {
			limit = {
				calc_true_if = {
					all_known_country = {
						AND = {
							is_great_power = yes
							is_ass_ally = {
								me = PREV
								target = THIS
							}
							great_power_rank = 6
						}
					}
					amount = 2
				}
			}
			change_variable = {
				which = UsedAssPointsMiddle
				value = 5
			}
		}
		if = {
			limit = {
				calc_true_if = {
					all_known_country = {
						AND = {
							is_great_power = yes
							is_ass_ally = {
								me = PREV
								target = THIS
							}
							great_power_rank = 6
						}
					}
					amount = 3
				}
			}
			change_variable = {
				which = UsedAssPointsMiddle
				value = 5
			}
		}
		if = {
			limit = {
				calc_true_if = {
					all_known_country = {
						AND = {
							is_great_power = yes
							is_ass_ally = {
								me = PREV
								target = THIS
							}
							great_power_rank = 6
						}
					}
					amount = 4
				}
			}
			change_variable = {
				which = UsedAssPointsMiddle
				value = 5
			}
		}
		if = {
			limit = {
				calc_true_if = {
					all_known_country = {
						AND = {
							is_great_power = yes
							is_ass_ally = {
								me = PREV
								target = THIS
							}
							great_power_rank = 6
						}
					}
					amount = 5
				}
			}
			change_variable = {
				which = UsedAssPointsMiddle
				value = 5
			}
		}

		#Great Powers

		if = {
			limit = {
				calc_true_if = {
					all_known_country = {
						AND = {
							is_great_power = yes
							is_ass_ally = {
								me = PREV
								target = THIS
							}
							great_power_rank = 1
							NOT = {
								great_power_rank = 6
							}
						}
					}
					amount = 1
				}
			}
			change_variable = {
				which = UsedAssPointsMajor
				value = 8
			}
		}
		if = {
			limit = {
				calc_true_if = {
					all_known_country = {
						AND = {
							is_great_power = yes
							is_ass_ally = {
								me = PREV
								target = THIS
							}
							great_power_rank = 1
							NOT = {
								great_power_rank = 6
							}
						}
					}
					amount = 2
				}
			}
			change_variable = {
				which = UsedAssPointsMajor
				value = 8
			}
		}
		if = {
			limit = {
				calc_true_if = {
					all_known_country = {
						AND = {
							is_great_power = yes
							is_ass_ally = {
								me = PREV
								target = THIS
							}
							great_power_rank = 1
							NOT = {
								great_power_rank = 6
							}
						}
					}
					amount = 3
				}
			}
			change_variable = {
				which = UsedAssPointsMajor
				value = 8
			}
		}
		if = {
			limit = {
				calc_true_if = {
					all_known_country = {
						AND = {
							is_great_power = yes
							is_ass_ally = {
								me = PREV
								target = THIS
							}
							great_power_rank = 1
							NOT = {
								great_power_rank = 6
							}
						}
					}
					amount = 4
				}
			}
			change_variable = {
				which = UsedAssPointsMajor
				value = 8
			}
		}
		if = {
			limit = {
				calc_true_if = {
					all_known_country = {
						AND = {
							is_great_power = yes
							is_ass_ally = {
								me = PREV
								target = THIS
							}
							great_power_rank = 1
							NOT = {
								great_power_rank = 6
							}
						}
					}
					amount = 5
				}
			}
			change_variable = {
				which = UsedAssPointsMajor
				value = 8
			}
		}
		
		#Vassals
		
		if = {
			limit = {
				calc_true_if = {
					all_subject_country = {
						AND = {
							is_lesser_in_union = no
							is_player = yes
						}
					}
					amount = 1
				}
			}
			change_variable = {
				which = UsedAssPointsVassalsUnder50
				value = 3
			}
		}
		if = {
			limit = {
				calc_true_if = {
					all_subject_country = {
						AND = {
							is_lesser_in_union = no
							is_player = yes
						}
					}
					amount = 2
				}
			}
			change_variable = {
				which = UsedAssPointsVassalsUnder50
				value = 3
			}
		}
		if = {
			limit = {
				calc_true_if = {
					all_subject_country = {
						AND = {
							is_lesser_in_union = no
							is_player = yes
						}
					}
					amount = 3
				}
			}
			change_variable = {
				which = UsedAssPointsVassalsUnder50
				value = 3
			}
		}
		if = {
			limit = {
				calc_true_if = {
					all_subject_country = {
						AND = {
							is_lesser_in_union = no
							is_player = yes
						}
					}
					amount = 4
				}
			}
			change_variable = {
				which = UsedAssPointsVassalsUnder50
				value = 3
			}
		}
		if = {
			limit = {
				calc_true_if = {
					all_subject_country = {
						AND = {
							is_lesser_in_union = no
							is_player = yes
						}
					}
					amount = 5
				}
			}
			change_variable = {
				which = UsedAssPointsVassalsUnder50
				value = 3
			}
		}
		#PUs
		if = {
			limit = {
				calc_true_if = {
					all_subject_country = {
						AND = {
							is_lesser_in_union = yes
							is_player = yes
						}
					}
					amount = 1
				}
			}
			change_variable = {
				which = UsedAssPointsPUUnder75
				value = 3
			}
		}
		if = {
			limit = {
				calc_true_if = {
					all_subject_country = {
						AND = {
							is_lesser_in_union = yes
							is_player = yes
						}
					}
					amount = 2
				}
			}
			change_variable = {
				which = UsedAssPointsPUUnder75
				value = 3
			}
		}
		if = {
			limit = {
				calc_true_if = {
					all_subject_country = {
						AND = {
							is_lesser_in_union = yes
							is_player = yes
						}
					}
					amount = 3
				}
			}
			change_variable = {
				which = UsedAssPointsPUUnder75
				value = 3
			}
		}
		if = {
			limit = {
				calc_true_if = {
					all_subject_country = {
						AND = {
							is_lesser_in_union = yes
							is_player = yes
						}
					}
					amount = 4
				}
			}
			change_variable = {
				which = UsedAssPointsPUUnder75
				value = 3
			}
		}
		if = {
			limit = {
				calc_true_if = {
					all_subject_country = {
						AND = {
							is_lesser_in_union = yes
							is_player = yes
						}
					}
					amount = 5
				}
			}
			change_variable = {
				which = UsedAssPointsPUUnder75
				value = 3
			}
		}
		#Lich/Vampire/WitchKing
		if = {
			limit = {
				calc_true_if = {
					all_known_country = {
						ass_ally_lich = {
							me = PREV
							target = THIS
						}
					}
					amount = 1
				}
			}
			change_variable = {
				which = UsedAssPointsLich
				value = 2
			}
		}
		if = {
			limit = {
				calc_true_if = {
					all_known_country = {
						ass_ally_lich = {
							me = PREV
							target = THIS
						}
					}
					amount = 2
				}
			}
			change_variable = {
				which = UsedAssPointsLich
				value = 2
			}
		}
		if = {
			limit = {
				calc_true_if = {
					all_known_country = {
						ass_ally_lich = {
							me = PREV
							target = THIS
						}
					}
					amount = 3
				}
			}
			change_variable = {
				which = UsedAssPointsLich
				value = 2
			}
		}
		#Undead
		if = {
			limit = {
				calc_true_if = {
					all_known_country = {
						is_ass_ally_undead = {
							me = PREV
							target = THIS
						}
					}
					amount = 1
				}
			}
			change_variable = {
				which = UsedAssPointsUndead
				value = 3
			}
		}
		if = {
			limit = {
				calc_true_if = {
					all_known_country = {
						is_ass_ally_undead = {
							me = PREV
							target = THIS
						}
					}
					amount = 2
				}
			}
			change_variable = {
				which = UsedAssPointsUndead
				value = 3
			}
		}
		#Ally vassals
		if = {
			limit = {
				calc_true_if = {
					AND = {
						all_known_country = {
							is_ass_ally = {
								me = PREV
								target = THIS
							}
							any_subject_country = {
								is_player = yes
							}
						}
					}
					amount = 1
				}
			}
			change_variable = {
				which = UsedAssPointsAllyVassals
				value = 3
			}
		}
		if = {
			limit = {
				calc_true_if = {
					AND = {
						all_known_country = {
							is_ass_ally = {
								me = PREV
								target = THIS
							}
							any_subject_country = {
								is_player = yes
							}
						}
					}
					amount = 2
				}
			}
			change_variable = {
				which = UsedAssPointsAllyVassals
				value = 3
			}
		}
		if = {
			limit = {
				calc_true_if = {
					AND = {
						all_known_country = {
							is_ass_ally = {
								me = PREV
								target = THIS
							}
							any_subject_country = {
								is_player = yes
							}
						}
					}
					amount = 3
				}
			}
			change_variable = {
				which = UsedAssPointsAllyVassals
				value = 3
			}
		}
		#Monstrous
		if = {
			limit = {
				AND = {
					calc_true_if = {
						all_known_country = {
							is_ass_ally_monstrous = {
								me = PREV
								target = THIS
							}
						}
						amount = 1
					}
					NOT = {
						has_country_modifier = monstrous_nation
					}
				}
			}
			change_variable = {
				which = UsedAssPointsMonstrous
				value = 4
			}
		}
		if = {
			limit = {
				AND = {
					calc_true_if = {
						all_known_country = {
							is_ass_ally_monstrous = {
								me = PREV
								target = THIS
							}
						}
						amount = 2
					}
					NOT = {
						has_country_modifier = monstrous_nation
					}
				}
			}
			change_variable = {
				which = UsedAssPointsMonstrous
				value = 4
			}
		}
		if = {
			limit = {
				AND = {
					calc_true_if = {
						all_known_country = {
							is_ass_ally_monstrous = {
								me = PREV
								target = THIS
							}
						}
						amount = 3
					}
					NOT = {
						has_country_modifier = monstrous_nation
					}
				}
			}
			change_variable = {
				which = UsedAssPointsMonstrous
				value = 4
			}
		}
		#Semi Monstous
		if = {
			limit = {
				AND = {
					calc_true_if = {
						all_known_country = {
							is_ass_ally_semi_monstrous = {
								me = PREV
								target = THIS
							}
						}
						amount = 1
					}
					NOT = {
						has_country_modifier = monstrous_nation
					}
				}
				
			}
			change_variable = {
				which = UsedAssPointsSemiMonstrous
				value = 2
			}
		}
		if = {
			limit = {
				AND = {
					calc_true_if = {
						all_known_country = {
							is_ass_ally_semi_monstrous = {
								me = PREV
								target = THIS
							}
						}
						amount = 2
					}
					NOT = {
						has_country_modifier = monstrous_nation
					}
				}
			}
			change_variable = {
				which = UsedAssPointsSemiMonstrous
				value = 2
			}
		}
		if = {
			limit = {
				AND = {
					calc_true_if = {
						all_known_country = {
							is_ass_ally_semi_monstrous = {
								me = PREV
								target = THIS
							}
						}
						amount = 3
					}
					NOT = {
						has_country_modifier = monstrous_nation
					}
				}
			}
			change_variable = {
				which = UsedAssPointsSemiMonstrous
				value = 2
			}
		}
		if = {
			limit = {
				AND = {
					calc_true_if = {
						all_known_country = {
							is_ass_ally_semi_monstrous = {
								me = PREV
								target = THIS
							}
						}
						amount = 4
					}
					NOT = {
						has_country_modifier = monstrous_nation
					}
				}
			}
			change_variable = {
				which = UsedAssPointsSemiMonstrous
				value = 2
			}
		}
		# sum up
		change_variable = {
			which = UsedAssPointsTotal
			which = UsedAssPointsMinor
		}
		change_variable = {
			which = UsedAssPointsTotal
			which = UsedAssPointsMajor
		}
		change_variable = {
			which = UsedAssPointsTotal
			which = UsedAssPointsMiddle
		}
		change_variable = {
			which = UsedAssPointsTotal
			which = UsedAssPointsVassalsUnder50
		}
		change_variable = {
			which = UsedAssPointsTotal
			which = UsedAssPointsAllyVassals
		}
		change_variable = {
			which = UsedAssPointsTotal
			which = UsedAssPointsPUUnder75
		}
		change_variable = {
			which = UsedAssPointsTotal
			which = UsedAssPointsLich
		}
		change_variable = {
			which = UsedAssPointsTotal
			which = UsedAssPointsUndead
		}
		change_variable = {
			which = UsedAssPointsTotal
			which = UsedAssPointsMonstrous
		}
		change_variable = {
			which = UsedAssPointsTotal
			which = UsedAssPointsSemiMonstrous
		}
		change_variable = {
			which = UsedAssPointsDifference
			which = MaxAssPoints
		}
		subtract_variable = {
			which = UsedAssPointsDifference
			which = UsedAssPointsTotal
		}
	}
}